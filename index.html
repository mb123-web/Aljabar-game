<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ambatron - Calculator & Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="https://challenges.cloudflare.com/cdn-cgi/challenge-platform/h/g/scripts/jsd/6122d059/main.js" async defer></script>
    
    <style>
        :root {
            --primary: #6366f1;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f8fafc;
            --success: #10b981;
            --error: #ef4444;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 450px;
            padding: 20px;
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .fade-out { opacity: 0; transform: scale(0.9); pointer-events: none; position: absolute; }
        .fade-in { opacity: 1; transform: scale(1); }

        .card {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        /* UI Kalkulator */
        .screen { background: #0f172a; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #334155; }
        input { width: 100%; background: transparent; border: none; color: #fff; font-size: 1.2rem; outline: none; }
        #result { color: var(--primary); font-weight: bold; margin-top: 5px; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        button { padding: 15px; border: none; border-radius: 8px; background: #334155; color: white; cursor: pointer; transition: 0.2s; }
        button:hover { background: #475569; }
        .btn-op { background: var(--primary); }
        .btn-equal { background: var(--success); grid-column: span 2; }

        /* UI Game */
        .game-header { text-align: center; margin-bottom: 20px; }
        .difficulty-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-diff { background: #475569; padding: 10px; }
        .easy { border-left: 5px solid #10b981; }
        .medium { border-left: 5px solid #f59e0b; }
        .hard { border-left: 5px solid #ef4444; }
        .impossible { border-left: 5px solid #7c3aed; }

        #game-play-zone { display: none; text-align: center; }
        #question { font-size: 1.8rem; margin: 20px 0; color: #fff; }
        #game-input { width: 80%; padding: 10px; border-radius: 5px; border: 1px solid var(--primary); background: #0f172a; color: white; text-align: center; font-size: 1.2rem; }
        #game-feedback { margin-top: 10px; font-weight: bold; }

        .link-game { display: block; text-align: center; margin-top: 20px; color: var(--primary); cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

<div id="calc-section" class="container fade-in">
    <div class="card">
        <h2 style="text-align:center; color: var(--primary);">Ambatron The Calc</h2>
        <div class="screen">
            <input type="text" id="input" placeholder="Ketik soal...">
            <div id="result">Hasil: </div>
        </div>
        <div class="grid">
            <button onclick="addChar('7')">7</button><button onclick="addChar('8')">8</button><button onclick="addChar('9')">9</button><button class="btn-op" onclick="addChar('/')">/</button>
            <button onclick="addChar('4')">4</button><button onclick="addChar('5')">5</button><button onclick="addChar('6')">6</button><button class="btn-op" onclick="addChar('*')">*</button>
            <button onclick="addChar('1')">1</button><button onclick="addChar('2')">2</button><button onclick="addChar('3')">3</button><button class="btn-op" onclick="addChar('-')">-</button>
            <button onclick="addChar('0')">0</button><button onclick="addChar('.')">.</button><button onclick="addChar('x')">x</button><button class="btn-op" onclick="addChar('+')">+</button>
            <button onclick="addChar('^')">^</button><button onclick="clearAll()">C</button>
            <button class="btn-equal" onclick="calculate()">HITUNG</button>
        </div>
        <span class="link-game" onclick="toggleMode('game')">Mau Test Kemampuan Mu?</span>
        
        <div style="margin-top:20px;" class="cf-turnstile" data-sitekey="your-site-key"></div>
    </div>
</div>

<div id="game-section" class="container fade-out">
    <div class="card">
        <div id="difficulty-selection">
            <h2 style="text-align:center;">Pilih Level</h2>
            <div class="difficulty-btns">
                <button class="btn-diff easy" onclick="startGame('easy')">Easy (10 Soal)</button>
                <button class="btn-diff medium" onclick="startGame('medium')">Medium (25 Soal)</button>
                <button class="btn-diff hard" onclick="startGame('hard')">Hard (35 Soal)</button>
                <button class="btn-diff impossible" onclick="startGame('impossible')">IMPOSSIBLE (50 Soal)</button>
            </div>
            <span class="link-game" onclick="toggleMode('calc')">Kembali ke Kalkulator</span>
        </div>

        <div id="game-play-zone">
            <div class="game-header">
                <span id="level-name">Level</span> | Soal: <span id="current-count">1</span>/<span id="total-count">10</span>
            </div>
            <div id="question">1 + 1</div>
            <input type="text" id="game-input" placeholder="Jawaban Anda..." autocomplete="off">
            <div id="game-feedback"></div>
            <button class="btn-equal" style="margin-top:20px; width:100%" onclick="checkAnswer()">JAWAB</button>
        </div>
    </div>
</div>

<script>
    // --- LOGIKA TRANSISI ---
    function toggleMode(target) {
        const calc = document.getElementById('calc-section');
        const game = document.getElementById('game-section');
        if(target === 'game') {
            calc.classList.replace('fade-in', 'fade-out');
            setTimeout(() => { game.classList.replace('fade-out', 'fade-in'); game.style.position = 'relative'; }, 800);
        } else {
            game.classList.replace('fade-in', 'fade-out');
            setTimeout(() => { calc.classList.replace('fade-out', 'fade-in'); calc.style.position = 'relative'; }, 800);
        }
    }

    // --- LOGIKA KALKULATOR ---
    const inputField = document.getElementById('input');
    const resultField = document.getElementById('result');
    function addChar(c) { inputField.value += c; }
    function clearAll() { inputField.value = ''; resultField.innerText = 'Hasil: '; }
    function calculate() {
        try {
            const res = math.evaluate(inputField.value);
            resultField.innerText = "Hasil: " + (typeof res === 'object' ? math.simplify(inputField.value) : res);
        } catch(e) { resultField.innerText = "Error!"; }
    }

    // --- LOGIKA GAME ---
    let gameState = { level: '', current: 1, total: 0, answer: '' };

    function startGame(lvl) {
        gameState.level = lvl;
        gameState.current = 1;
        gameState.total = lvl === 'easy' ? 10 : lvl === 'medium' ? 25 : lvl === 'hard' ? 35 : 50;
        
        document.getElementById('difficulty-selection').style.display = 'none';
        document.getElementById('game-play-zone').style.display = 'block';
        document.getElementById('level-name').innerText = lvl.toUpperCase();
        document.getElementById('total-count').innerText = gameState.total;
        generateQuestion();
    }

    function generateQuestion() {
        let q = "";
        let ans = "";
        const lvl = gameState.level;

        if(lvl === 'easy') {
            let a = math.randomInt(1, 20), b = math.randomInt(1, 20);
            q = `${a} + ${b}`; ans = a + b;
        } else if(lvl === 'medium') {
            let a = math.randomInt(10, 50), b = math.randomInt(5, 15);
            let ops = ['+', '-', '*'];
            let op = ops[math.randomInt(0,3)];
            q = `${a} ${op} ${b}`; ans = math.evaluate(q);
        } else if(lvl === 'hard') {
            let a = math.randomInt(2, 10);
            q = `${a}^2 + ${math.randomInt(10,100)}`; ans = math.evaluate(q);
        } else { // IMPOSSIBLE: Aljabar & Perkalian
            let a = math.randomInt(2, 5);
            let x = math.randomInt(2, 10);
            q = `Selesaikan: ${a}x = ${a * x}, x=?`; ans = x;
        }

        document.getElementById('question').innerText = q;
        gameState.answer = ans.toString();
        document.getElementById('current-count').innerText = gameState.current;
        document.getElementById('game-input').value = '';
        document.getElementById('game-feedback').innerText = '';
    }

    function checkAnswer() {
        const userAns = document.getElementById('game-input').value;
        const feedback = document.getElementById('game-feedback');

        if(userAns == gameState.answer) {
            feedback.style.color = 'var(--success)';
            feedback.innerText = "BENAR!";
            setTimeout(() => {
                if(gameState.current < gameState.total) {
                    gameState.current++;
                    generateQuestion();
                } else {
                    alert("SELAMAT! Kamu Menaklukkan Level " + gameState.level);
                    resetGame();
                }
            }, 1000);
        } else {
            feedback.style.color = 'var(--error)';
            feedback.innerText = "SALAH! Coba lagi sampai benar.";
        }
    }

    function resetGame() {
        document.getElementById('difficulty-selection').style.display = 'block';
        document.getElementById('game-play-zone').style.display = 'none';
        toggleMode('calc');
    }
</script>

</body>
</html>
